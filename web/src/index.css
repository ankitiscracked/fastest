@import "tailwindcss";

@source "../node_modules/streamdown/dist/index.js";

@theme {
  /* Surface colors - warm stone neutrals */
  --color-surface-50: oklch(0.985 0.002 75);
  --color-surface-100: oklch(0.97 0.004 75);
  --color-surface-200: oklch(0.923 0.008 75);
  --color-surface-300: oklch(0.869 0.012 75);
  --color-surface-400: oklch(0.709 0.015 75);
  --color-surface-500: oklch(0.553 0.015 75);
  --color-surface-600: oklch(0.444 0.014 75);
  --color-surface-700: oklch(0.37 0.013 75);
  --color-surface-800: oklch(0.268 0.011 75);
  --color-surface-900: oklch(0.216 0.01 75);

  /* Accent colors - stone (monochromatic) */
  --color-accent-50: oklch(0.869 0.012 75);
  --color-accent-100: oklch(0.709 0.015 75);
  --color-accent-200: oklch(0.553 0.015 75);
  --color-accent-300: oklch(0.444 0.014 75);
  --color-accent-400: oklch(0.37 0.013 75);
  --color-accent-500: oklch(0.268 0.011 75);
  --color-accent-600: oklch(0.216 0.01 75);
  --color-accent-700: oklch(0.186 0.009 75);
  --color-accent-800: oklch(0.156 0.008 75);
  --color-accent-900: oklch(0.126 0.007 75);

  /* Status colors */
  --color-status-running: oklch(0.623 0.214 255);
  --color-status-success: oklch(0.723 0.219 142);
  --color-status-error: oklch(0.637 0.237 25);
  --color-status-warning: oklch(0.769 0.188 70);
  --color-status-pending: oklch(0.709 0.015 75);

  /* Font sizes */
  --font-size-xs: 0.75rem;
  --font-size-xs--line-height: 1rem;
  --font-size-sm: 0.8125rem;
  --font-size-sm--line-height: 1.25rem;
  --font-size-base: 0.875rem;
  --font-size-base--line-height: 1.5rem;
  --font-size-lg: 1rem;
  --font-size-lg--line-height: 1.75rem;
  --font-size-xl: 1.125rem;
  --font-size-xl--line-height: 1.75rem;
  --font-size-2xl: 1.25rem;
  --font-size-2xl--line-height: 1.875rem;
  --font-size-3xl: 1.5rem;
  --font-size-3xl--line-height: 2rem;

  /* Animations */
  --animate-pulse-subtle: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  --animate-slide-up: slideUp 0.2s ease-out;
  --animate-slide-down: slideDown 0.2s ease-out;
  --animate-fade-in: fadeIn 0.15s ease-out;

  @keyframes slideUp {
    0% { transform: translateY(4px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }

  @keyframes slideDown {
    0% { transform: translateY(-4px); opacity: 0; }
    100% { transform: translateY(0); opacity: 1; }
  }

  @keyframes fadeIn {
    0% { opacity: 0; }
    100% { opacity: 1; }
  }

  @keyframes shimmer {
    0% { background-position: 200% center; }
    100% { background-position: -200% center; }
  }

  --animate-shimmer: shimmer 3s linear infinite;
}

/* Dark mode support (future) */
@variant dark (&:where(.dark, .dark *));

@layer base {
  body {
    @apply bg-surface-50 text-surface-700 antialiased;
    font-size: 14px;
  }
}

@layer components {
  /* Button variants */
  .btn {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none;
  }

  .btn-primary {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none bg-accent-500 text-white hover:bg-accent-600 active:bg-accent-700;
  }

  .btn-secondary {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none bg-surface-100 text-surface-700 hover:bg-surface-200 active:bg-surface-300 border border-surface-200;
  }

  .btn-ghost {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none text-surface-600 hover:bg-surface-100 active:bg-surface-200;
  }

  .btn-danger {
    @apply inline-flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium rounded-md transition-colors focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none bg-status-error text-white hover:bg-red-600 active:bg-red-700;
  }

  /* Card component */
  .card {
    @apply bg-white rounded-md border border-surface-200 shadow-sm;
  }

  /* Input styles */
  .input {
    @apply w-full px-3 py-2 text-sm bg-white border border-surface-200 rounded-md placeholder:text-surface-400 focus:outline-none focus:border-surface-400 transition-colors;
  }

  /* Status badges */
  .badge {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm;
  }

  .badge-running {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm bg-status-running/10 text-status-running;
  }

  .badge-success {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm bg-status-success/10 text-status-success;
  }

  .badge-error {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm bg-status-error/10 text-status-error;
  }

  .badge-warning {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm bg-status-warning/10 text-status-warning;
  }

  .badge-pending {
    @apply inline-flex items-center gap-1.5 px-2 py-0.5 text-xs font-medium rounded-sm bg-surface-100 text-surface-600;
  }

  /* Code block wrapper */
  .code-block-wrapper {
    @apply relative;
  }

  /* Code copy button */
  .code-copy-btn {
    @apply absolute top-2 right-2 flex items-center gap-1 px-2 py-1 text-[10px] font-medium text-surface-400 bg-surface-100/90 border border-surface-200 rounded-sm cursor-pointer opacity-0 transition-all backdrop-blur-sm;
  }

  .code-block-wrapper:hover .code-copy-btn {
    @apply opacity-100;
  }

  .code-copy-btn:hover {
    @apply text-surface-700 bg-surface-200 border-surface-300;
  }

  .code-copy-btn.copied {
    @apply text-status-success border-status-success/30;
  }

  /* Reasoning block */
  .reasoning-block {
    @apply relative my-3 py-3 px-4 bg-gradient-to-br from-surface-50 to-accent-50/30 border border-surface-200 border-l-[3px] border-l-accent-400 rounded-md;
  }

  .reasoning-block summary {
    @apply flex items-center gap-2 cursor-pointer text-xs font-medium text-surface-500 select-none list-none;
  }

  .reasoning-block summary::-webkit-details-marker {
    @apply hidden;
  }

  .reasoning-content {
    @apply mt-3 pt-3 border-t border-surface-200 text-sm text-surface-600 leading-relaxed;
  }

  /* Patch visualization */
  .patch-visualization {
    @apply mt-2;
  }

  .patch-file-item {
    @apply flex items-center gap-2 py-1.5 text-xs font-mono border-b border-surface-100 last:border-b-0;
  }

  .patch-file-badge {
    @apply shrink-0 w-5 h-5 flex items-center justify-center text-[10px] font-semibold rounded-sm text-white;
  }

  .patch-file-badge.added {
    @apply bg-status-success;
  }

  .patch-file-badge.modified {
    @apply bg-status-warning;
  }

  .patch-file-badge.deleted {
    @apply bg-status-error;
  }

  /* Tool status badges */
  .tool-status {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 text-[10px] font-semibold rounded-sm;
  }

  .tool-status.pending {
    @apply bg-surface-100 text-surface-500;
  }

  .tool-status.running {
    @apply bg-status-running/10 text-status-running;
  }

  .tool-status.success {
    @apply bg-status-success/10 text-status-success;
  }

  .tool-status.error {
    @apply bg-status-error/10 text-status-error;
  }

  /* Terminal/log viewer (dark theme) */
  .terminal {
    @apply bg-surface-900 text-surface-100 rounded-md overflow-hidden font-mono text-xs;
  }

  .terminal-header {
    @apply flex items-center justify-between px-4 py-2 bg-surface-800 border-b border-surface-700;
  }

  .terminal-content {
    @apply p-4 overflow-auto;
  }

  .terminal-line {
    @apply flex gap-2 py-0.5 hover:bg-surface-800/50;
  }

  .terminal-timestamp {
    @apply text-surface-500 select-none w-20 shrink-0;
  }

  .terminal-step {
    @apply w-16 shrink-0;
  }

  .terminal-step-install {
    @apply text-status-running;
  }

  .terminal-step-build {
    @apply text-status-warning;
  }

  .terminal-step-deploy {
    @apply text-status-success;
  }

  .terminal-output {
    @apply text-surface-100 break-all whitespace-pre-wrap;
  }

  .terminal-error {
    @apply text-status-error;
  }
}

@utility focus-ring {
  @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-surface-400 focus-visible:ring-offset-2;
}

@utility pulse-running {
  @apply animate-pulse;
}

/* Shimmer text effect */
.shimmer-text {
  background: linear-gradient(
    90deg,
    var(--color-surface-400) 0%,
    var(--color-surface-400) 40%,
    var(--color-surface-600) 50%,
    var(--color-surface-400) 60%,
    var(--color-surface-400) 100%
  );
  background-size: 200% auto;
  background-clip: text;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: shimmer 3s linear infinite;
}
